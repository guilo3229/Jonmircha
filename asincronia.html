<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asincronia en Javascript</title>
</head>
<body>
    <h1>Asincronia en Javascropt</h1> 
</body>
<script>
// function cuadradoCallback(value,callback){
//     setTimeout(() => {
//         callback(value,value*value)
//     }, 0| Math.random()*1000);
// }
// // El callback es el primer mecanismo que tenemos para manejar la sincronia en orden
// cuadradoCallback(0,(value,result) =>{
// console.log("inicia callback") 
// console.log(`Callback:${value}, ${result} `)
//     cuadradoCallback(1,(value,result) =>{
   
//     console.log(`Callback:${value}, ${result} `)
    
//         cuadradoCallback(2,(value,result) =>{
   
//         console.log(`Callback:${value}, ${result} `)
       
//             cuadradoCallback(3,(value,result) =>{
   
//             console.log(`Callback:${value}, ${result} `)
            
//                 cuadradoCallback(4,(value,result) =>{
   
//                 console.log(`Callback:${value}, ${result} `)
                  
//                     cuadradoCallback(5,(value,result) =>{
   
//                     console.log(`Callback:${value}, ${result} `)
//                      })  
//                 })
//             })
//         })         

//     })
// })


function cuadradoPromise(value){
    if(typeof value !== "number")
        return Promise.reject(`Error, el valor " ${value}" ingresado no es un nÃºmero`);
        
    return new Promise((resolve,reject)=> {
    setTimeout(() => {
        // El resolve es el return positivo de la promesa es decir cuando se cumple
        resolve({
            value,
            result:value*value
        });
    }, 0| Math.random()*1000);
    });
}
// El mtodo then se ejecutara desues de la funcion principal, podemos tener todos los metodos then que nosotros necesitemos y finalmente tendremos un metodo que seria el catch que cogeria el error
cuadradoPromise(0)
    .then(obj => {
        console.log("inicio Promise");
        console.log(`Promise:${obj.value},${obj.result} `)
        return cuadradoPromise(1)
     })
     .then(obj =>{
        console.log(`Promise:${obj.value},${obj.result} `)
        return cuadradoPromise(2)
     })
     .then(obj =>{
        console.log(`Promise:${obj.value},${obj.result} `)
        return cuadradoPromise("3")
     })
     .then(obj =>{
        console.log(`Promise:${obj.value},${obj.result} `)
        return cuadradoPromise(4)
     })
     .then(obj =>{
        console.log(`Promise:${obj.value},${obj.result} `)
        return cuadradoPromise(5)

     })
     .then(obj =>{
        console.log(`Promise:${obj.value},${obj.result} `)
        console.log("Fin de la promesa")
     })
    .catch(err => console.error(err));


</script>
</html>